(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4520],{5407:(e,r,t)=>{Promise.resolve().then(t.bind(t,7778))},7778:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>u});var s=t(5155),o=t(199),a=t(6046),n=t(2115);function u(){let{login:e}=(0,o.A)(),r=(0,a.useRouter)(),[t,u]=(0,n.useState)(""),[i,l]=(0,n.useState)({username:"",password:""}),c=async t=>{t.preventDefault(),u("");try{console.log("Submitting login form:",i);let t=await e(i);t.success?(r.push("/"),r.refresh()):u(t.error||"로그인에 실패했습니다")}catch(e){u("로그인 처리 중 오류가 발생했습니다")}},d=e=>{let{name:r,value:t}=e.target;l(e=>({...e,[r]:t}))};return(0,s.jsx)("div",{className:"auth-form-container",children:(0,s.jsxs)("form",{onSubmit:c,className:"auth-form",children:[(0,s.jsx)("h2",{children:"로그인"}),t&&(0,s.jsx)("div",{className:"error-message",children:t}),(0,s.jsx)("input",{name:"username",value:i.username,onChange:d,placeholder:"사용자 이름 또는 닉네임",required:!0}),(0,s.jsx)("input",{name:"password",type:"password",value:i.password,onChange:d,placeholder:"비밀번호",required:!0}),(0,s.jsx)("button",{type:"submit",children:"로그인"})]})})}},199:(e,r,t)=>{"use strict";t.d(r,{A:()=>n,AuthProvider:()=>u});var s=t(5155),o=t(2115);let a=(0,o.createContext)(),n=()=>{let e=(0,o.useContext)(a);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};function u(e){let{children:r}=e,[t,n]=(0,o.useState)(null),[u,i]=(0,o.useState)(!0);(0,o.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("user");if(e){let r=JSON.parse(e);n(r)}}catch(e){console.error("Auth check failed:",e),localStorage.removeItem("user"),n(null)}finally{i(!1)}})()},[]);let l=async e=>{try{console.log("Attempting login...");let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),cache:"no-store"}),t=await r.json();if(!r.ok)return{success:!1,error:t.message||"로그인에 실패했습니다"};return n(t),localStorage.setItem("user",JSON.stringify(t)),console.log("Login successful"),{success:!0}}catch(e){return console.error("Login error:",e),{success:!1,error:"로그인 처리 중 오류가 발생했습니다"}}},c=async e=>{try{if(!(null==t?void 0:t._id))return!1;if((await fetch("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t._id,profileData:e})})).ok){let r={...t,...e};return n(r),localStorage.setItem("user",JSON.stringify(r)),!0}return!1}catch(e){return console.error("Profile update failed:",e),!1}};return(0,s.jsx)(a.Provider,{value:{user:t,loading:u,login:l,logout:()=>{n(null),localStorage.removeItem("user")},updateProfile:c,isAuthenticated:!!t,isLoading:u},children:r})}},6046:(e,r,t)=>{"use strict";var s=t(6658);t.o(s,"useParams")&&t.d(r,{useParams:function(){return s.useParams}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}})}},e=>{var r=r=>e(e.s=r);e.O(0,[8441,1517,7358],()=>r(5407)),_N_E=e.O()}]);